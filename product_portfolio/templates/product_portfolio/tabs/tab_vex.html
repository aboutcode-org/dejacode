{% load i18n %}
{% load as_icon from dje_tags %}
{% load urlize_target_blank from dje_tags %}
{% spaceless %}
<table class="table table-bordered table-md text-break">
  <thead>
    <tr>
      <th style="min-width: 6px;"></th>
      <th style="min-width: 150px;">
        {% trans 'Package' %}
      </th>
      <th style="min-width: 100px;">
        {% trans 'Vulnerability' %}
      </th>
      <th style="min-width: 100px;">
        {% trans 'State' %}
      </th>
      <th style="min-width: 100px;">
        {% trans 'Responses' %}
      </th>
      <th style="width: 200px;">
        {% trans 'Justification' %}
      </th>
      <th style="width: 200px;">
        {% trans 'Detail' %}
      </th>
    </tr>
  </thead>
  <tbody>
    {% for vex in values.vex_items %}
        {% cycle 'table-odd' '' as rowcolors silent %}
        <tr class="{{ rowcolors }}">
          <td>
              <a href="{% url 'product_portfolio:package_vex_change' vex.dataspace vex.productpackage.id vex.vulnerability_id %}" data-bs-toggle="tooltip" title="Edit"{% if 'admin' in object_change_url %} target="_blank"{% endif %} aria-label="Edit object"><i class="far fa-edit"></i></a>
          </td>
          <td{% if vex.productpackage %} data-purl="{{ vex.productpackage.package.aboutcode_data.package_url }}"{% endif %}>
          {% include 'product_portfolio/includes/productrelation_element.html' with relation=vex.productpackage %}
          </td>
          <td>
            <a href="{{ vex.vulnerability_url }}" target="_blank">{{ vex.vulnerability_id }}</a>
          </td>
          <td>{{ vex.get_state_display }}</td>
          <td class="text-center">
              <ul>
                {% for response in vex.get_responses_choices  %}
                    <li>{{ response }}</li>
                {% endfor %}
              </ul>
          </td>
          <td class="text-center">{{ vex.get_justification_display }}</td>
          <td class="text-center">{{ vex.detail }}</td>
        </tr>
    {% empty %}
      <tr><td colspan="100">No results.</td></tr>
    {% endfor %}
  </tbody>
</table>
{% endspaceless %}