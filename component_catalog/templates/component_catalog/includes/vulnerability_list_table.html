{% load i18n %}
{% load inject_preserved_filters from dje_tags %}
{% load urlize_target_blank from dje_tags %}
{% load naturaltime_short from dje_tags %}

<table id="object-list-table" class="table table-bordered table-striped table-md text-break vulnerabilities-table">
  {% include 'includes/object_list_table_header.html' %}
  <tbody>
  {% for vulnerability in object_list %}
    <tr>
      <td>
        <strong>
          <a href="{{ vulnerablecode_url }}vulnerabilities/{{ vulnerability.vulnerability_id }}" target="_blank">
            {{ vulnerability.vulnerability_id }}
            <i class="fa-solid fa-up-right-from-square mini"></i>
          </a>
        </strong>
      </td>
      <td>
        {% include 'component_catalog/includes/vulnerability_aliases.html' with aliases=vulnerability.aliases only %}
      </td>
      <td>
        {% if vulnerability.lowest_score %}
          {{ vulnerability.lowest_score }} -
        {% endif %}
        {% if vulnerability.highest_score %}
          <strong>
            {{ vulnerability.highest_score }}
          </strong>
        {% endif %}
      </td>
<!--      <td>-->
<!--        {% if vulnerability.priority %}-->
<!--          {{ vulnerability.priority }}-->
<!--        {% endif %}-->
<!--      </td>-->
      <td>
        {% if vulnerability.summary %}
          {% if vulnerability.summary|length > 120 %}
            <details>
              <summary>{{ vulnerability.summary|slice:":120" }}...</summary>
              {{ vulnerability.summary|slice:"120:" }}
            </details>
          {% else %}
            {{ vulnerability.summary }}
          {% endif %}
        {% endif %}
      </td>
      <td>
        {{ vulnerability.affected_packages_count }}
      </td>
      <td>
        {{ vulnerability.fixed_packages_length }}
      </td>
    </tr>
  {% empty %}
    <tr><td colspan="10">No results.</td></tr>
  {% endfor %}
  </tbody>
</table>